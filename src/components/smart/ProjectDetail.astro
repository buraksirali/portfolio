---
import { createTranslator, type Locale } from '../../i18n';
import { getProjectBySlug } from '../../server/db';
import Section from '../ui/Section.astro';

export interface Props {
	slug: string;
}

const { slug } = Astro.props;
const locale = (Astro.locals.locale ?? 'en') as Locale;
const translator = createTranslator(locale);
const project = await getProjectBySlug(slug, locale);
---

{project ? (
	<Section title={project.translation?.hero_title ?? project.translation?.name ?? project.slug}>
		<div class="space-y-4 bg-[color:var(--color-surface)] border border-[color:var(--color-border)] rounded-2xl p-6 shadow-card">
			<p class="text-[color:var(--color-muted)]">{project.translation?.description}</p>
			{project.tech && (
				<p class="text-sm text-[color:var(--color-text)]">
					<strong>{translator('projects.tech')}:</strong> {project.tech}
				</p>
			)}
			{project.link && (
				<a class="inline-flex items-center gap-2 font-semibold text-[color:var(--color-primary)]" href={project.link}>
					{translator('projects.link')}
					<span aria-hidden="true">↗</span>
				</a>
			)}
			<a class="inline-flex items-center gap-2 text-sm" href={`/${locale}/projects/`}>
				← {translator('projects.back')}
			</a>
		</div>
	</Section>
) : (
	<p class="text-[color:var(--color-muted)]">{translator('errors.notFound')}</p>
)}
