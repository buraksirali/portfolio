---
import { createTranslator, type Locale } from '../../i18n';
import { getPages } from '../../server/db';
import Section from '../ui/Section.astro';

export interface Props {
	slug: string;
}

const { slug } = Astro.props;
const locale = (Astro.locals.locale ?? 'en') as Locale;
const translator = createTranslator(locale);
const pages = await getPages(locale);
const page = pages.find((p) => p.slug === slug && p.published);
---

{page ? (
	<Section title={translator('pages.title')} description={translator('pages.sections')}>
		<div class="space-y-6">
			{page.sections.map((section) => (
				<article class="bg-[color:var(--color-surface)] border border-[color:var(--color-border)] rounded-2xl p-6 shadow-card">
					<h3 class="text-xl font-semibold text-[color:var(--color-text)]">{section.heading}</h3>
					<p class="text-[color:var(--color-muted)]">{section.body}</p>
				</article>
			))}
		</div>
	</Section>
) : (
	<p class="text-[color:var(--color-muted)]">{translator('errors.notFound')}</p>
)}
