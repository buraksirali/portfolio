---
import { createTranslator, type Locale } from '../../i18n';
import { getProjects } from '../../server/db';
import Card from '../ui/Card.astro';
import Section from '../ui/Section.astro';

const locale = (Astro.locals.locale ?? 'en') as Locale;
const translator = createTranslator(locale);
const projects = getProjects(locale);
---

<Section title={translator('projects.title')}>
	{projects.length === 0 ? (
		<p class="text-[color:var(--color-muted)]">{translator('projects.empty')}</p>
	) : (
		<div class="grid md:grid-cols-2">
			{projects.map((project) => (
				<Card
					title={project.translation?.name ?? project.slug}
					description={project.translation?.description}
					eyebrow={project.status === 'published' ? translator('admin.published') : translator('admin.draft')}
					tags={project.tech?.split(',').map((tech) => tech.trim()) ?? []}
					href={`/${locale}/projects/${project.slug}/`}
					linkLabel={translator('projects.view')}
				/>
			))}
		</div>
	)}
</Section>
